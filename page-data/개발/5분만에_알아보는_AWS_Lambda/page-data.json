{"componentChunkName":"component---src-templates-blog-post-js","path":"/개발/5분만에_알아보는_AWS_Lambda/","result":{"data":{"site":{"siteMetadata":{"title":"Hoon's Blog"}},"markdownRemark":{"id":"b6237048-e4d2-59fe-8310-8eeaf2840db2","excerpt":"클라우드 서비스 덕에 서버가 없어도, 서버 관리자가 없어도 소수의 인원이 웹서비스를 만들고 운용할 수 있는 시대가 도래하였습니다. 그것이 가능한 이유 중 하나인 Serverless를 AWS Lambda…","html":"<blockquote>\n<p>클라우드 서비스 덕에 서버가 없어도, 서버 관리자가 없어도 소수의 인원이 웹서비스를 만들고 운용할 수 있는 시대가 도래하였습니다. 그것이 가능한 이유 중 하나인 Serverless를 AWS Lambda 예제를 이용하여 알아보겠습니다.</p>\n</blockquote>\n<h2>서버리스란</h2>\n<p>서버리스는 운용하는 입장에서 서버에 대한 관리가 필요하지 않은 서비스입니다. 서버는 클라우드 서비스에서 관리해 주고, 사용자는 실행에 필요한 함수에 대해서만 관리를 하면 됩니다. 사용하지 않더라도 서버를 켜 놓은 시간에 대해서 비용이 발생하는 가상서버와는 달리, 서버리스는 함수를 실행시키는 데에 필요한 리소스에 대한 비용만을 지불하면 됩니다. 대표적인 서버리스 서비스는 AWS Lambda, GCP Functions, Azure functions가 있습니다.</p>\n<p>서버리스를 이용하면 API를 손쉽게 만들 수 있을 뿐만 아니라, 다른 클라우드 서비스와 트리거를 설정해 놓으면, 실시간 파일 처리 등의 서비스를 구현 할 수 있습니다.</p>\n<p>이번 포스트에서는 AWS Lambda와 파이썬을 이용하여 간단한 API를 만들어보겠습니다.</p>\n<h2>서버리스 프레임워크</h2>\n<p><a href=\"https://serverless.com/\">서버리스 프레임워크</a>는 서버리스 서비스를 더욱 간편하게 이용 할 수 있게 해주는 오픈소스 프레임워크입니다. 서버리스 프레임워크를 이용하면, 서버리스에 사용될 함수의 개발, 테스트, 배포 단계를 편리하게 하실 수 있습니다.</p>\n<h3>Node.js 설치</h3>\n<p>서버리스 프레임워크는 <a href=\"https://nodejs.org/ko/\">Node.js</a>가 설치되어있어야 하는데, 맥에서 <a href=\"https://github.com/nvm-sh/nvm\">nvm</a>을 통해 Node.js를 설치하기 위해서는 아래 명령어를 이용하면 됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># nvm 설치</span>\n<span class=\"token function\">curl</span> -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.3/install.sh <span class=\"token operator\">|</span> <span class=\"token function\">bash</span>\n\n<span class=\"token comment\"># Node.js LTS 버전 설치</span>\nnvm <span class=\"token function\">install</span> --lts</code></pre></div>\n<h3>서버리스 프레임워크 설치</h3>\n<p>서버리스 프레임워크는 아래의 명령어로 간편하게 설치하실 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> -g serverless</code></pre></div>\n<h3>AWS 계정설정</h3>\n<p>서버리스 프레임워크에서 AWS 계정에 접근하기 위해서는 환경변수에 AWS credentials를 등록해야 합니다. 아래 명령어로 환경변수에 AWS credentials를 일회성으로 등록 할 수 있고, 쉘 실행 시에 자동으로 등록해주기 위해서는 아래 명령어를 ~/.bashrc 나 ~/.zshrc 파일에 넣어주면 됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">AWS_ACCESS_KEY_ID</span><span class=\"token operator\">=</span>AKIAIOSFODNN7EXAMPLE\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">AWS_SECRET_ACCESS_KEY</span><span class=\"token operator\">=</span>wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">AWS_DEFAULT_REGION</span><span class=\"token operator\">=</span>us-west-2</code></pre></div>\n<h2>AWS Lambda와 파이썬으로 API 만들기</h2>\n<h3>서버리스 프레임워크 템플릿</h3>\n<p>서버리스 프레임워크의 큰 장점은 템플릿이 많이 존재한다는 것입니다. 어떤 템플릿들이 존재하는지 궁금하시면 아래 명령어를 입력하시면 됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">serverless create -t</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c5635a99457d38114083eb63a87d4c59/42de8/serverless_templates.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.56756756756756%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAAClklEQVQ4y5VSy07bQBQdCLS8umilQO34Gb/tgB0nceIECCQRCZAYJFZ8Q78IZdFFP6Jl0U0/pZK77rIiyUzvndK0CyrUSEdndGdy7rnnmoyIULidpL100rtu17uT3uAiu7y5zSbjcXZ1dZ1dXFxmw+EoG41G2enpaXZ2dpb1ej2OwWCQtdvtLE3TSafTuQH45M3qZjFJom9RJ2Fh4LNa6LGkFbNqNWRhGDLXdQEOZ9u2OTuOs4RpmswwDOZ5Hr6/I/ATPc/Oq6HPgoo193ybBgCoARwaBB41TYMqisKhqipnSZKoLMu/8VAul7HZlBQKq8L+/n4exzVWrzcWwLRajWm9XqcwAoVR6fn5OYURab/fp8PhkN/FcUxrNXxbRX5oNpvs4OBgSra3twXommuaxoAX0B2ZQVdmWRbr93vs8PCQo9vtLs/Hx8ecQZhVKpUZxuP7/pRsbW0JpVIphxEYYPHIDGo8s/F4zMAVOzo64gLgmoEjnhk2xDeQ5QzEsDYl6+vrAhRzLAAv8CEGj04ty+ROUCSKIi6EjiAiDnDGAec/gpubG4Ki4Mg6jKrByCoXE8US3+DJyQkXwkh0XV8yLgEZNwy1GZ65ICEbQlmXc9fF7JSF73ssgM/HdW1wbIKjCEayeQyY61OAu9lyy4S8FAxDzisVDbpqi1arwdK0CRuPH78/G+o6/yM6fwpwN0OnQRD8cgiCX9upxhoN9cEw5bnjyPMgUOayLM1VVZorigznfwMc/sB4kiS5I4WVF6JeVr83U4fFkclMcOO6ZRb4OnTXeGbPAV3iIlut1geyQchrQZLevzWsz4qof7Kk0j04u9/dLd7v7e0CP49isfhRFMUvIPqOkLW1FQwS8Aqw88j/g52/eO0nCLBYbp3btZYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"서버리스 템플릿\"\n        title=\"서버리스 템플릿\"\n        src=\"/static/c5635a99457d38114083eb63a87d4c59/fcda8/serverless_templates.png\"\n        srcset=\"/static/c5635a99457d38114083eb63a87d4c59/12f09/serverless_templates.png 148w,\n/static/c5635a99457d38114083eb63a87d4c59/e4a3f/serverless_templates.png 295w,\n/static/c5635a99457d38114083eb63a87d4c59/fcda8/serverless_templates.png 590w,\n/static/c5635a99457d38114083eb63a87d4c59/efc66/serverless_templates.png 885w,\n/static/c5635a99457d38114083eb63a87d4c59/42de8/serverless_templates.png 1033w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>서버리스 프레임워크는 여러 가지 클라우드 서비스와 여러 가지 언어의 조합으로 템플릿을 제공하는데, 우리는 AWS Lambda를 python3로 이용하는 aws-python3 템플릿을 사용하여 프로젝트를 만들겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">serverless create -t aws-python3</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/812487d36a8bbcca469a81a5b651932a/e80ac/serverless_aws-python3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.621621621621614%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABy0lEQVQoz52Q3Y6TQBTHW9f0ci/cAoktM0OB4aO0FFrEjxayGJOWkth0Y3yJfYhN9ln2xjuzxo+9UXun77MJWuR4KLbZeGWc5JdzYJgf/zONBq7zZCq+Ohubz89e6+nLjMfzJZ/PM75YpDxNFzzLMr5cpjyKIr5arfh6vcbn5a7HPT1JEtPzPKmxX6f+8CrOZuC9SG+jx3EeBV4eRc/yJDnN4zjOp9NpPptFyCyfTCY5Hs5d193XW8dxIAzDN3vfkWZo74YjFwxD+WUaBCwuY0+AcwqUEkQGxghCodPp/E1JCAGUfkLX/Z1QYQ+vdU0GTSPbnkpL06KlbdPScWg5GtFyMKgqKy2LlLJMKsFdtowx6Pf7Hw5CxuRrrvdAYWRLaBcTdUFRdj/ADymmpWCada0SV2mrVLIsVxSU7oQfD8LgUfA2WaTghf6P0LeLp2NeBAEvMGWBwsKy6mr/qcMBLfBKCk0lha6Tn5wzHLn//iDkpnHjxTHo7hiCwROIPBds28I0FKpxqru7S/2e4hT1nqr2wPf9zwfhg5OTi7Yofhck6YvQFjdCu70RBGEjiuK/8FWSpG+qql7WwnvNJjbHSAfp/ifV2eNWq9X8DWGpv+K1mPLAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"서버리스 aws-python3\"\n        title=\"서버리스 aws-python3\"\n        src=\"/static/812487d36a8bbcca469a81a5b651932a/fcda8/serverless_aws-python3.png\"\n        srcset=\"/static/812487d36a8bbcca469a81a5b651932a/12f09/serverless_aws-python3.png 148w,\n/static/812487d36a8bbcca469a81a5b651932a/e4a3f/serverless_aws-python3.png 295w,\n/static/812487d36a8bbcca469a81a5b651932a/fcda8/serverless_aws-python3.png 590w,\n/static/812487d36a8bbcca469a81a5b651932a/e80ac/serverless_aws-python3.png 809w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>만들어진 프로젝트에는 handler.py와 serverless.yml, 그리고 .gitignore, 모두 세 개의 파일이 존재합니다. <br>\nhandler.py는 우리가 클라우드 서비스에서 실행시킬 함수가 들어있고, serverless.yml에는 서버리스 프레임워크의 설정값이 들어있습니다.</p>\n<h3>serverless.yml 수정</h3>\n<p>serverless.yml의 기본값에는 API 관련 내용과 AWS region 설정이 빠져있습니다. 따라서 해당 내용을 추가하여 아래와 같이 수정해줍니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">service</span><span class=\"token punctuation\">:</span> serverless\n\n<span class=\"token key atrule\">provider</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> aws\n  <span class=\"token key atrule\">runtime</span><span class=\"token punctuation\">:</span> python3.8\n  <span class=\"token comment\"># region 추가</span>\n  <span class=\"token key atrule\">region</span><span class=\"token punctuation\">:</span> ap<span class=\"token punctuation\">-</span>northeast<span class=\"token punctuation\">-</span><span class=\"token number\">2</span>\n\n<span class=\"token key atrule\">functions</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">hello</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">handler</span><span class=\"token punctuation\">:</span> handler.hello\n    <span class=\"token comment\"># API 설정 추가</span>\n    <span class=\"token key atrule\">events</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">http</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">method</span><span class=\"token punctuation\">:</span> get\n          <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> test\n          <span class=\"token key atrule\">cors</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>\n<h3>hello.py 수정</h3>\n<p>hello.py를 조금 수정해서 API get method를 이용해 파라미터를 받아오는 예제를 만들어 보겠습니다.</p>\n<p>hello.py를 아래와 같이 수정합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> json\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">hello</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    body <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"message\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Go Serverless v1.0! Your function executed successfully!\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token comment\"># event 내용 중 API에서 넘겨주는 queryStringParameters 출력</span>\n        <span class=\"token string\">\"input\"</span><span class=\"token punctuation\">:</span> event<span class=\"token punctuation\">[</span><span class=\"token string\">'queryStringParameters'</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n\n    response <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"statusCode\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"body\"</span><span class=\"token punctuation\">:</span> json<span class=\"token punctuation\">.</span>dumps<span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> response</code></pre></div>\n<h3>API 배포</h3>\n<p>서버리스 프레임워크의 아래 명령어로 API를 배포 할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">serverless deploy</code></pre></div>\n<p>배포 완료 후, endpoint에 API 주소가 나타납니다. 그 주소 제일 뒤에 ?age=100을 추가하여 API를 테스트해 보겠습니다. 아래와 같은 출력이 나온다면 성공입니다. 웹브라우저나 curl을 이용하여 테스트해 보시면 됩니다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 522px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/09908cad07466ba56b14d757550b1170/29492/serverless_result.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.05405405405405%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACBklEQVQoz62Tz4/SUBDHWUCjAS4GYW2BRci6sP2xIIUWKW2plJYfhcjGsEc3kODBeNJsuMjZLD0Y/zUTTv4fmuIb51UlejBRY5NvZua9eZ/MzHsNwdmT0P/4JEk6+OHfeKYZL54/ld5rl6ONczH3bMvwLLvnaR3Tsx3Hc1D9ft/r9Xpet9v1bNv2LMui8abdbr/jeb5CQZ1OB6G3bqceCdzH0UQHaTaG1vkFGG0XHN0BtyXD47YGg6EDw+EQJpMxjMdjmE6nMJvNYDAYgOu60Gw2X1LgYrEIU1uoK8oHoSpBucx/5njOF4SHflWs+OJp2ec5zq9Wq36lgrEoBpbG2KJfr9c/ybIMgiC8oqDlchkAi4osb0ejIXQt64vSbBJFkYmu68Q0TdJoNAIfDxNN0wi2j/sKQQip1Wo79KFUKl1R0Hw+p8CD4tH97FZUVRANcyfiofJJi8hCg3TPOCKWToluaOT4+AHBWRGskhQKBZLNZkkmk/FxDVBX+5aj0WiRZdlthmWBYe7tGIahiYRlGcKw7Hf/m6V7VBSWy+Xo+i/AoMJwOFzA5O1RPg+Y9FeicJwnqKr6mgLX63Uww7uJROIS9TYej1//pM1v/L1isdh1Mpl8k0qlZOREV6tV8A5vou6gsqj8P+gQFUdoeP/KaZBOpyNo/1g0H6uL4AVF8JaDvwQAQl8B8jbSvZteLjAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"서버리스 결과\"\n        title=\"서버리스 결과\"\n        src=\"/static/09908cad07466ba56b14d757550b1170/29492/serverless_result.png\"\n        srcset=\"/static/09908cad07466ba56b14d757550b1170/12f09/serverless_result.png 148w,\n/static/09908cad07466ba56b14d757550b1170/e4a3f/serverless_result.png 295w,\n/static/09908cad07466ba56b14d757550b1170/29492/serverless_result.png 522w\"\n        sizes=\"(max-width: 522px) 100vw, 522px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>축하드립니다! 서버리스를 이용하여 API를 완성하셨습니다!</p>\n<h2>마지막으로</h2>\n<p>서버에 대한 고민 없이, 서버리스 프레임워크의 설정값과 함수만을 이용하여 API를 만들어보았습니다. 서버리스 프레임워크를 활용하면, CPU를 이용하는 간단한 딥러닝 모델도 API 형태로 서빙을 할 수 있습니다. 다음번에는 서버리스를 이용하여 딥러닝 모델을 배포하는 방법에 대해 살펴보겠습니다.</p>","frontmatter":{"title":"5분 만에 알아보는 AWS Lambda","date":"April 26, 2020","description":"예제와 함께하는 AWS Lambda with Python"}}},"pageContext":{"slug":"/개발/5분만에_알아보는_AWS_Lambda/","previous":{"fields":{"slug":"/개발/5분만에_알아보는_웹스크래핑/"},"frontmatter":{"title":"5분 만에 알아보는 파이썬 웹 스크래핑"}},"next":{"fields":{"slug":"/기타/맥북_청소/"},"frontmatter":{"title":"맥북 생명연장 프로젝트 (1) - 청소"}}}},"staticQueryHashes":["4211413508","63159454"]}